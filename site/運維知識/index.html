<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>運維知識 - Darren</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "\u904b\u7dad\u77e5\u8b58";
        var mkdocs_page_input_path = "\u904b\u7dad\u77e5\u8b58.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../image/favicon.ico" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../note/">使用 MkDocs 建立文件網站教學筆記</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../%E5%AE%B9%E5%99%A8%E7%9F%A5%E8%AD%98/">Linux 容器筆記</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../docker_commands/">Docker常用命令</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ansible%E7%B0%A1%E4%BB%8B%E5%8F%8A%E7%94%A8%E6%B3%95/">Ansible簡介及用法</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">運維知識</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1">1. 定位與用途</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2">2. 套件與管理方式</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3">3. 維護與更新</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4">4. 使用情境</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5">5. 安全與一致性</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_1">總結表格</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1-ignition">1. Ignition 是什麼？</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-rhcos-ignition-rhel">2. 為什麼 RHCOS 可以用 Ignition，但 RHEL 不能？</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-immutable-linux">3. Immutable Linux 系列整理</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#31-rhcosred-hat-coreos">3.1 RHCOS（Red Hat CoreOS）</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#32-fedora-coreos-fcos">3.2 Fedora CoreOS (FCOS)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#33-ubuntu-core">3.3 Ubuntu Core</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#34-fedora-silverblue">3.4 Fedora Silverblue</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#vagrant-vmware-provider">Vagrant 流浪漢教學 (使用 VMware Provider)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1-vagrant">1️⃣ 介紹 Vagrant 與用途</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2_1">2️⃣ 確認環境</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#21">2.1 錯誤訊息解釋</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-vagrant">3️⃣ 建立 Vagrant 專案資料夾</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#5-vm">5️⃣ 啟動 VM</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Darren</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">運維知識</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="rhcos-rhel">RHCOS 與 RHEL 差異整理</h1>
<h2 id="1">1. 定位與用途</h2>
<ul>
<li><strong>RHEL (Red Hat Enterprise Linux)</strong>: 通用型作業系統，適用於各種伺服器與應用。</li>
<li><strong>RHCOS (Red Hat CoreOS)</strong>: 為 OpenShift/Kubernetes 設計的專用 OS，只能作為 Node 使用。</li>
</ul>
<h2 id="2">2. 套件與管理方式</h2>
<ul>
<li><strong>RHEL</strong>: 提供 yum/dnf，可自由安裝與修改。</li>
<li><strong>RHCOS</strong>: 不提供完整套件管理，透過 MachineConfig Operator (MCO) 與 rpm-ostree 更新。</li>
</ul>
<h2 id="3">3. 維護與更新</h2>
<ul>
<li><strong>RHEL</strong>: 傳統 patch/update 模型，需管理員決定。</li>
<li><strong>RHCOS</strong>: 原子性更新，由 OpenShift Operator 自動控制。</li>
</ul>
<h2 id="4">4. 使用情境</h2>
<ul>
<li><strong>RHEL</strong>: 資料庫、應用伺服器、虛擬化、一般伺服器。</li>
<li><strong>RHCOS</strong>: 專用於 OpenShift Master/Worker 節點。</li>
</ul>
<h2 id="5">5. 安全與一致性</h2>
<ul>
<li><strong>RHEL</strong>: 高度可自訂，安全性依賴管理員維護。</li>
<li><strong>RHCOS</strong>: 不可變設計，節點一致性高，由 Operator 控制。</li>
</ul>
<hr />
<h2 id="_1">總結表格</h2>
<table>
<thead>
<tr>
<th>特性</th>
<th><strong>RHEL</strong></th>
<th><strong>RHCOS</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>定位</td>
<td>通用型 OS</td>
<td>Kubernetes/OpenShift 專用 OS</td>
</tr>
<tr>
<td>套件管理</td>
<td>yum/dnf 可自由安裝</td>
<td>不可手動安裝，透過 MCO 管理</td>
</tr>
<tr>
<td>系統彈性</td>
<td>高，自由修改</td>
<td>低，幾乎唯讀</td>
</tr>
<tr>
<td>更新方式</td>
<td>傳統 patch/update</td>
<td>原子性 ostree 更新</td>
</tr>
<tr>
<td>適用場景</td>
<td>DB、應用伺服器、VM、一般伺服器</td>
<td>OpenShift Master/Worker 節點</td>
</tr>
<tr>
<td>管理方式</td>
<td>系統管理員</td>
<td>OpenShift Operator 自動化</td>
</tr>
<tr>
<td>---</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="1-ignition">1. Ignition 是什麼？</h2>
<ul>
<li><strong>Ignition</strong> 是專為 <strong>Immutable Linux 系統（如 CoreOS 家族）</strong> 設計的 <strong>開機初始化工具</strong>。  </li>
<li>它在 <strong>第一次開機（first boot）</strong> 時讀取 <code>.ign</code> 配置檔，完成以下操作：</li>
<li>磁碟分割與格式化  </li>
<li>檔案寫入（例如 ssh key、配置檔）  </li>
<li>使用者建立  </li>
<li>systemd 服務設定  </li>
<li><strong>特點</strong>：</li>
<li>僅作用於 <strong>第一次開機</strong>，之後不會再執行  </li>
<li>保證系統從一開始就達到 <strong>一致的狀態</strong>  </li>
<li>適合自動化、無人值守部署大規模叢集  </li>
</ul>
<p><strong>簡單理解</strong>：專注於 <strong>底層初始化與不可變系統設定</strong>，而非套件安裝或日後修改。
<img alt="Ignition檔案.png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/Ignition%E6%AA%94%E6%A1%88.png" title="Ignition檔案.png" /></p>
<hr />
<h2 id="2-rhcos-ignition-rhel">2. 為什麼 RHCOS 可以用 Ignition，但 RHEL 不能？</h2>
<ul>
<li><strong>RHCOS / FCOS (Fedora)</strong>：</li>
<li><strong>Immutable OS</strong>：系統不可變，核心與套件由映像管理，初始狀態必須在第一次開機就寫好  </li>
<li><strong>原生支援 Ignition</strong>：開機前讀取 <code>.ign</code>，完成磁碟、使用者、network、systemd 設定  </li>
<li><strong>RHEL / Rocky Linux / RHCL</strong>：</li>
<li><strong>Mutable OS</strong>：系統可自由修改，套件和設定可隨時變更  </li>
<li><strong>不支援 Ignition</strong>：使用 <strong>Kickstart</strong> 或 <strong>cloud-init</strong> 進行自動化安裝  </li>
<li>核心差異：RHEL 的操作層與文件系統架構不兼容 <code>.ign</code> JSON 配置  </li>
</ul>
<p><strong>結論</strong>：RHCOS/FCOS 設計就是為了 <strong>初始開機即設定完整狀態</strong>，因此支持 Ignition；RHEL 是傳統可變系統，初始安裝後再修改設定，無法使用 Ignition。</p>
<hr />
<h2 id="3-immutable-linux">3. Immutable Linux 系列整理</h2>
<h3 id="31-rhcosred-hat-coreos">3.1 RHCOS（Red Hat CoreOS）</h3>
<ul>
<li><strong>用途</strong>: 專為 OpenShift Kubernetes 平台設計  </li>
<li><strong>特性</strong>:</li>
<li>Immutable OS  </li>
<li>自動化更新（OSTree 映像）  </li>
<li>內建容器化，預設支援 Kubernetes  </li>
<li>Ignition 支援（bootstrap、networking、使用者、ssh key）  </li>
<li>無人值守安裝  </li>
</ul>
<h3 id="32-fedora-coreos-fcos">3.2 Fedora CoreOS (FCOS)</h3>
<ul>
<li><strong>開發者</strong>: Red Hat 社群版（RHCOS 上游）  </li>
<li><strong>特點</strong>:</li>
<li>Immutable OS  </li>
<li>自動更新，可滾動或暫停  </li>
<li>內建 Podman、container tools  </li>
<li>使用 Ignition 作初始化設定  </li>
<li><strong>用途</strong>:</li>
<li>Kubernetes 節點  </li>
<li>自建 K8s 或 OpenShift 社群版  </li>
</ul>
<h3 id="33-ubuntu-core">3.3 Ubuntu Core</h3>
<ul>
<li><strong>開發者</strong>: Canonical  </li>
<li><strong>特點</strong>:</li>
<li>Snaps 管理應用與系統  </li>
<li>Immutable 系統核心  </li>
<li>強調 IoT 與邊緣運算  </li>
<li><strong>用途</strong>:</li>
<li>IoT 裝置  </li>
<li>Kubernetes 節點（需 MicroK8s 或 kubeadm）  </li>
</ul>
<h3 id="34-fedora-silverblue">3.4 Fedora Silverblue</h3>
<ul>
<li><strong>性質</strong>: Immutable Desktop Linux  </li>
<li><strong>開發者</strong>: Fedora Project 社群（Red Hat 支持）  </li>
<li><strong>核心概念</strong>:</li>
<li>不可變系統，核心與套件固定  </li>
<li>原子更新，可回滾  </li>
<li>鼓勵容器化應用（Flatpak）  </li>
<li><strong>定位</strong>:</li>
<li>Silverblue = Immutable Desktop  </li>
<li>Fedora CoreOS = Immutable Server / K8s 節點  </li>
<li>RHCOS = 企業級 CoreOS，專為 OpenShift  </li>
</ul>
<hr />
<h2 id="vagrant-vmware-provider">Vagrant 流浪漢教學 (使用 VMware Provider)</h2>
<p>本文完整整理了 Vagrant 使用 VMware Provider 的流程，包括環境確認、建立專案、Vagrantfile 配置、啟動 VM、SSH 連線與常用指令，並保留原文說明與提示。</p>
<hr />
<h2 id="1-vagrant">1️⃣ 介紹 Vagrant 與用途</h2>
<p>Vagrant 是 HashiCorp 開發的一個工具，用來建立和管理虛擬機環境。它可以透過不同虛擬化提供者 (VirtualBox、VMware 等) 建立統一的開發環境，使團隊開發、測試和部署更一致。主要特點：</p>
<ul>
<li><strong>自動化環境配置</strong>：透過 Vagrantfile 定義 VM 配置，包括 OS、網路、CPU、RAM。</li>
<li><strong>跨平台</strong>：支援 Windows、Linux、macOS。</li>
<li><strong>整合 Provisioner</strong>：可使用 Ansible、Chef、Puppet 或 Shell script 自動安裝軟體。</li>
<li><strong>易於版本控制</strong>：Vagrantfile 可放入 git，讓團隊共用同一環境配置。</li>
</ul>
<p>用途舉例：</p>
<ul>
<li>開發者快速搭建測試環境。</li>
<li>測試多 OS 或多網路配置。</li>
<li>自動化部署軟體或服務。</li>
</ul>
<hr />
<h2 id="2_1">2️⃣ 確認環境</h2>
<p>在 PowerShell 或 CMD 輸入：</p>
<pre><code class="language-powershell">vagrant --version
</code></pre>
<p>說明：</p>
<blockquote>
<p>若顯示版本號，例如 Vagrant 2.x.x，代表 Vagrant 已成功安裝。</p>
</blockquote>
<p>VMware 也安裝完成後，確保 Vagrant 能使用 VMware provider：</p>
<pre><code class="language-powershell">vagrant plugin list
</code></pre>
<p>你應該看到：</p>
<pre><code>vagrant-vmware-desktop
</code></pre>
<p><img alt="vagrant plugin list.png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/vagrant%20plugin%20list.png" title="vagrant plugin list.png" /></p>
<p>若沒有，請先安裝插件：
<img alt="vagrant plugin list 還沒裝.png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/vagrant%20plugin%20list%20%E9%82%84%E6%B2%92%E8%A3%9D.png" title="vagrant plugin list 還沒裝.png" /></p>
<pre><code class="language-powershell">vagrant plugin install vagrant-vmware-desktop
</code></pre>
<h3 id="21">2.1 錯誤訊息解釋</h3>
<p>若啟動 VM 時出現：</p>
<pre><code>Vagrant encountered an error while attempting to load the utility
service key file. This error can occur if the Vagrant VMware Utility
has not yet been installed, or if it was installed incorrectly.
...
Path:  C:/ProgramData/hashicorp/vagrant-vmware-desktop/certificates/vagrant-utility.client.crt
Error: No such file or directory
</code></pre>
<p>意思是：</p>
<blockquote>
<p>你有安裝 vagrant-vmware-desktop 插件，但缺少 Vagrant VMware Utility 這個外掛程式需要的「後端服務」。</p>
</blockquote>
<p>解決方式：</p>
<ol>
<li>
<p>安裝 Vagrant VMware Utility</p>
</li>
<li>
<p>到 HashiCorp 官方下載工具：
     <a href="https://developer.hashicorp.com/vagrant/install/vmware">Vagrant VMware Utility Download</a></p>
</li>
<li>下載 Windows 版 MSI 安裝檔，執行安裝。</li>
</ol>
<hr />
<h2 id="3-vagrant">3️⃣ 建立 Vagrant 專案資料夾</h2>
<p>輸入：</p>
<pre><code class="language-powershell">vagrant init
</code></pre>
<p><img alt="vagrant init.png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/vagrant%20init.png" title="vagrant init.png" /></p>
<p>說明：</p>
<blockquote>
<p>這會建立一個 Vagrantfile。
此目錄中已儲存一個 <code>Vagrantfile</code>。
現在，您可以 <code>vagrant up</code> 您的第一個虛擬環境了！
請閱讀 Vagrantfile 中的註解以及 <code>vagrantup.com</code> 上的文檔，以了解更多關於使用 Vagrant 的資訊。</p>
</blockquote>
<hr />
<pre><code>
### 4.1 完整 Vagrantfile 範例

```ruby
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.box = &quot;rockylinux/9&quot;

  # 私有網路
  config.vm.network &quot;private_network&quot;, ip: &quot;192.168.126.100&quot;

  # 公用網路 (橋接)
  config.vm.network &quot;public_network&quot;, bridge: &quot;VMware Network Adapter VMnet8&quot;

  # VMware Provider 專屬設定
  config.vm.provider &quot;vmware_desktop&quot; do |v|
    v.gui = false
    v.memory = 2048
    v.cpus = 2
  end

  # Shell Provisioner 範例
  # config.vm.provision &quot;shell&quot;, inline: &lt;&lt;-SHELL
  #   dnf -y update
  #   dnf -y install htop
  # SHELL
end
</code></pre>
<p><img alt="rocky9.png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/rocky9.png" title="rocky9.png" /></p>
<hr />
<h2 id="5-vm">5️⃣ 啟動 VM</h2>
<pre><code class="language-powershell">vagrant up --provider=vmware_desktop
</code></pre>
<p><img alt="vagrant up .png" src="../image/%E9%81%8B%E7%B6%AD%E7%9F%A5%E8%AD%98/vagrant%20up%20.png" title="vagrant up .png" /></p>
<blockquote>
<p>成功後代表 Vagrant 幫你在 VMware Workstation / Fusion 裡建立並啟動一台虛擬機。</p>
</blockquote>
<h1 id="vagrant-vm-vmware-provider">Vagrant 建立多台 VM 範例 (使用 VMware Provider)</h1>
<p>以下示範如何在 Vagrantfile 中定義多台虛擬機 (VM)，並分別啟動。</p>
<hr />
<h2 id="vagrantfile">Vagrantfile 範例</h2>
<h1 id="vagrant-vmvmware-provider">Vagrant 建立多台 VM（VMware Provider）</h1>
<pre><code class="language-ruby">Vagrant.configure(&quot;2&quot;) do |config|
  # 指定 box（可依需求修改）
  config.vm.box = &quot;rockylinux/9&quot;

  config.vm.define &quot;vm1&quot; do |vm1|
    vm1.vm.hostname = &quot;vm1&quot;
  end

  config.vm.define &quot;vm2&quot; do |vm2|
    vm2.vm.hostname = &quot;vm2&quot;
  end
end

# 啟動第一台
vagrant up vm1 --provider=vmware_desktop

# 啟動第二台
vagrant up vm2 --provider=vmware_desktop

# 也可一次啟動全部
vagrant up --provider=vmware_desktop

</code></pre>
<hr />
<h2 id="6-ssh-vm">6️⃣ SSH 連線 VM</h2>
<pre><code class="language-powershell">vagrant ssh
</code></pre>
<blockquote>
<p>若 Windows 沒有 SSH Client，可先透過 <code>vagrant ssh-config</code> 查詢連線資訊，再用其他 SSH 工具 (例如 PuTTY) 連線。</p>
</blockquote>
<p>預設帳號密碼：</p>
<pre><code>vagrant / vagrant
</code></pre>
<hr />
<h2 id="7">7️⃣ 常用操作指令</h2>
<table>
<thead>
<tr>
<th>指令</th>
<th>功能</th>
<th>備註</th>
</tr>
</thead>
<tbody>
<tr>
<td>vagrant status</td>
<td>查看目前 VM 狀態</td>
<td>顯示 running / poweroff</td>
</tr>
<tr>
<td>vagrant ssh</td>
<td>進入 VM</td>
<td>Windows 下要安裝 SSH Client 或用 vagrant ssh-config 搭配 ssh</td>
</tr>
<tr>
<td>vagrant halt</td>
<td>關機 (正常 shutdown)</td>
<td>相當於在 VM 裡下 shutdown -h now</td>
</tr>
<tr>
<td>vagrant suspend</td>
<td>暫停 VM (類似睡眠)</td>
<td>下次 vagrant resume 可以快速恢復</td>
</tr>
<tr>
<td>vagrant resume</td>
<td>喚醒 VM</td>
<td>對應 suspend</td>
</tr>
<tr>
<td>vagrant reload</td>
<td>重啟 VM 並套用 Vagrantfile 修改</td>
<td>例如改了記憶體或網路設定</td>
</tr>
<tr>
<td>vagrant destroy</td>
<td>刪除 VM (連同硬碟)</td>
<td>會完全清除，慎用！</td>
</tr>
</tbody>
</table>
<hr />
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ansible%E7%B0%A1%E4%BB%8B%E5%8F%8A%E7%94%A8%E6%B3%95/" class="btn btn-neutral float-left" title="Ansible簡介及用法"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../ansible%E7%B0%A1%E4%BB%8B%E5%8F%8A%E7%94%A8%E6%B3%95/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
